(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{8072:function(e,t,n){Promise.resolve().then(n.bind(n,2950)),Promise.resolve().then(n.t.bind(n,6809,23))},2950:function(e,t,n){"use strict";n.d(t,{AuthProvider:function(){return s},a:function(){return l}});var r=n(7437),o=n(2265),a=n(5864);let i=(0,o.createContext)(null);function s(e){let{children:t}=e,[n,s]=(0,o.useState)(null),[l,d]=(0,o.useState)(!0),u=(0,o.useCallback)(()=>{let e=localStorage.getItem("adminToken"),t=localStorage.getItem("adminUser");if(e&&t)try{return{token:e,admin:JSON.parse(t)}}catch(e){localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser")}return null},[]),c=(0,o.useCallback)(()=>{localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser"),s(null),window.location.href="/login"},[]),m=(0,o.useCallback)(async()=>{if(!u()){d(!1);return}try{let e=await a.Nq.getMe(),t=null==e?void 0:e.data,n=null==t?void 0:t.data;if(!(null==t?void 0:t.success)||!n){c();return}let r=(n.role||"").toLowerCase();if("admin"!==r&&"superadmin"!==r){c();return}s(n),localStorage.setItem("adminUser",JSON.stringify(n))}catch(e){c()}finally{d(!1)}},[u,c]);(0,o.useEffect)(()=>{m()},[m]);let g=async(e,t)=>{var n,r,o,i,l,d,u;try{let i=await a.Nq.login(e,t),l=null==i?void 0:i.data,d=null==l?void 0:l.data;if(console.log("Login Response:",{success:null==l?void 0:l.success,role:null==d?void 0:null===(n=d.admin)||void 0===n?void 0:n.role}),!(null==l?void 0:l.success)||!(null==d?void 0:d.token)||!(null==d?void 0:d.admin))return{success:!1,message:null!==(o=null==l?void 0:l.message)&&void 0!==o?o:"Login failed"};let u=String((null===(r=d.admin)||void 0===r?void 0:r.role)||"").toLowerCase();if("admin"!==u&&"superadmin"!==u)return console.error("Access Denied: Invalid role",u),{success:!1,message:"Access denied. Admin or superadmin role required."};return localStorage.setItem("adminToken",d.token),localStorage.setItem("adminUser",JSON.stringify(d.admin)),s(d.admin),{success:!0}}catch(e){return{success:!1,message:null!==(u=null!==(d=null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(i=l.data)||void 0===i?void 0:i.message)&&void 0!==d?d:null==e?void 0:e.message)&&void 0!==u?u:"Login failed"}}},v=!!n&&("admin"===n.role||"superadmin"===n.role);return(0,r.jsx)(i.Provider,{value:{admin:n,loading:l,login:g,logout:c,isAuthenticated:v},children:t})}function l(){let e=(0,o.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},5864:function(e,t,n){"use strict";n.d(t,{Nq:function(){return i}});let r=n(3464).Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}}),o=["/admin/auth/me","/admin/dashboard","/admin/products","/admin/orders","/admin/users"],a=e=>o.some(t=>null==e?void 0:e.includes(t));r.interceptors.request.use(e=>{{let t=localStorage.getItem("adminToken");if(a(e.url)&&!t)return window.location.href="/login",Promise.reject(Error("Admin authentication required"));t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),r.interceptors.response.use(e=>e,e=>{var t;let n=null===(t=e.response)||void 0===t?void 0:t.status;return(401===n||403===n)&&(localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser"),window.location.href="/login"),Promise.reject(e)});let i={login:(e,t)=>r.post("/admin/auth/login",{email:e,password:t}),getMe:()=>r.get("/admin/auth/me"),getStats:()=>r.get("/admin/dashboard/stats"),getProducts:()=>r.get("/admin/products"),createProduct:e=>r.post("/admin/products",e),updateProduct:(e,t)=>r.put("/admin/products/".concat(e),t),deleteProduct:e=>r.delete("/admin/products/".concat(e)),getOrders:e=>r.get("/admin/orders",{params:e}),updateOrderStatus:(e,t)=>r.put("/admin/orders/".concat(e),t),verifyOrder:(e,t)=>r.patch("/admin/orders/".concat(e,"/verify"),{status:t}),deleteOrder:e=>r.delete("/admin/orders/".concat(e)),getUsers:()=>r.get("/admin/users"),updateUser:(e,t)=>r.put("/admin/users/".concat(e),t),deleteUser:e=>r.delete("/admin/users/".concat(e))}},6809:function(){}},function(e){e.O(0,[982,464,971,117,744],function(){return e(e.s=8072)}),_N_E=e.O()}]);