(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[570],{1440:function(e,t,s){Promise.resolve().then(s.bind(s,6573))},6573:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var a=s(7437),i=s(2265),r=s(5864);function n(e){let{product:t,onClose:s,onSuccess:n}=e,[c,d]=(0,i.useState)({name:"",description:"",price:"",category:"",stock:"0",isActive:!0,images:[]}),[l,o]=(0,i.useState)(""),[m,u]=(0,i.useState)([]),[p,h]=(0,i.useState)(""),[g,v]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(t){var e,s;d({name:t.name||"",description:t.description||"",price:String(null!==(e=t.price)&&void 0!==e?e:""),category:t.category||"",stock:String(null!==(s=t.stock)&&void 0!==s?s:0),isActive:!1!==t.isActive,images:Array.isArray(t.images)?t.images:[]}),o(Array.isArray(t.images)?t.images.join("\n"):""),u(Array.isArray(t.images)?t.images:[])}},[t]);let j=e=>{let{name:t,value:s,type:a,checked:i}=e.target;d(e=>({...e,[t]:"checkbox"===a?i:s}))},x=e=>{u(t=>t.filter((t,s)=>s!==e)),d(t=>({...t,images:t.images.filter((t,s)=>s!==e)}))},b=async e=>{e.preventDefault(),h(""),v(!0);let s=c.images.length>0?c.images:l.split("\n").map(e=>e.trim()).filter(Boolean);if(0===s.length){h("At least one image is required"),v(!1);return}let a={name:c.name.trim(),description:c.description.trim(),price:parseFloat(c.price)||0,category:c.category.trim(),stock:parseInt(c.stock,10)||0,isActive:c.isActive,images:s};try{(null==t?void 0:t._id)?await r.Nq.updateProduct(t._id,a):await r.Nq.createProduct(a),null==n||n()}catch(e){var i,d;h((null===(d=e.response)||void 0===d?void 0:null===(i=d.data)||void 0===i?void 0:i.message)||"Failed to save product")}finally{v(!1)}};return(0,a.jsx)("div",{className:"modal-overlay",onClick:s,children:(0,a.jsxs)("div",{className:"modal modal-large",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h3",{children:t?"Edit Product":"Add Product"}),(0,a.jsx)("button",{type:"button",className:"modal-close",onClick:s,children:"\xd7"})]}),(0,a.jsxs)("form",{onSubmit:b,className:"modal-body",children:[p&&(0,a.jsx)("div",{className:"form-error",children:p}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Name *"}),(0,a.jsx)("input",{name:"name",value:c.name,onChange:j,required:!0,placeholder:"Product name"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Description *"}),(0,a.jsx)("textarea",{name:"description",value:c.description,onChange:j,required:!0,rows:3,placeholder:"Product description"})]}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Price (₹) *"}),(0,a.jsx)("input",{type:"number",name:"price",value:c.price,onChange:j,required:!0,min:"0",step:"0.01"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Stock"}),(0,a.jsx)("input",{type:"number",name:"stock",value:c.stock,onChange:j,min:"0"})]})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Category *"}),(0,a.jsx)("input",{name:"category",value:c.category,onChange:j,required:!0,placeholder:"e.g. Desi Ghee"})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Images *"}),(0,a.jsxs)("div",{className:"image-upload-section",children:[(0,a.jsxs)("div",{className:"image-upload-input",children:[(0,a.jsx)("input",{type:"file",multiple:!0,accept:"image/png,image/jpeg,image/jpg,image/gif,image/webp",onChange:e=>{let t=Array.from(e.target.files||[]);0!==t.length&&t.forEach(e=>{let t=new FileReader;t.onload=()=>{let e=String(t.result);u(t=>[...t,e]),d(t=>({...t,images:[...t.images,e]}))},t.readAsDataURL(e)})},id:"image-select",style:{display:"none"}}),(0,a.jsx)("button",{type:"button",className:"btn-upload",onClick:()=>document.getElementById("image-select").click(),children:"\uD83D\uDCC1 Choose Photos"}),(0,a.jsx)("small",{children:"Upload product images from your device (PNG, JPG, GIF, WebP)"})]}),m.length>0&&(0,a.jsx)("div",{className:"image-preview-grid",children:m.map((e,t)=>(0,a.jsxs)("div",{className:"image-preview-item",children:[(0,a.jsx)("img",{src:e,alt:"Preview ".concat(t+1),style:{maxWidth:"100%",maxHeight:"150px",objectFit:"cover"}}),(0,a.jsx)("button",{type:"button",className:"btn-remove-image",onClick:()=>x(t),title:"Remove image",children:"✕"})]},t))})]})]}),(0,a.jsx)("div",{className:"form-group form-check",children:(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"checkbox",name:"isActive",checked:c.isActive,onChange:j}),"Active (visible to customers)"]})}),(0,a.jsxs)("div",{className:"modal-footer",children:[(0,a.jsx)("button",{type:"button",className:"btn-secondary",onClick:s,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"btn-primary",disabled:g,children:g?"Saving...":t?"Update":"Create"})]})]})]})})}function c(){let[e,t]=(0,i.useState)([]),[s,c]=(0,i.useState)(!0),[d,l]=(0,i.useState)(null),[o,m]=(0,i.useState)(!1),[u,p]=(0,i.useState)(null),h=()=>{c(!0),r.Nq.getProducts().then(e=>{var s,a;(null===(s=e.data)||void 0===s?void 0:s.success)&&(null===(a=e.data)||void 0===a?void 0:a.data)&&t(e.data.data)}).catch(e=>{var t,s;return l((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Failed to load products")}).finally(()=>c(!1))};(0,i.useEffect)(()=>{h()},[]);let g=e=>{p(e),m(!0)},v=()=>{m(!1),p(null),h()},j=async(e,t)=>{if(confirm('Delete product "'.concat(t,'"?')))try{await r.Nq.deleteProduct(e),h()}catch(e){var s,a;alert((null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)||"Failed to delete")}};return s?(0,a.jsx)("div",{className:"loading-state",children:"Loading products..."}):d?(0,a.jsx)("div",{className:"error-state",children:d}):(0,a.jsxs)("div",{className:"products-page",children:[(0,a.jsxs)("div",{className:"page-header-responsive",children:[(0,a.jsx)("h2",{children:"Products"}),(0,a.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>{p(null),m(!0)},children:"+ Add"})]}),(0,a.jsx)("div",{className:"table-container-desktop",children:(0,a.jsxs)("table",{className:"admin-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Product"}),(0,a.jsx)("th",{children:"Category"}),(0,a.jsx)("th",{children:"Price"}),(0,a.jsx)("th",{children:"Stock"}),(0,a.jsx)("th",{children:"Status"}),(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsx)("tbody",{children:0===e.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:6,children:"No products yet. Add your first product."})}):e.map(e=>{var t,s;return(0,a.jsxs)("tr",{onClick:()=>g(e),className:"clickable-row",style:{cursor:"pointer"},children:[(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"product-cell",children:[(null===(t=e.images)||void 0===t?void 0:t[0])&&(0,a.jsx)("img",{src:e.images[0],alt:"",className:"product-thumb"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:e.name}),e.description&&(0,a.jsxs)("span",{className:"product-desc",children:[e.description.slice(0,50),"..."]})]})]})}),(0,a.jsx)("td",{children:e.category}),(0,a.jsxs)("td",{children:["₹",Number(e.price).toLocaleString()]}),(0,a.jsx)("td",{children:null!==(s=e.stock)&&void 0!==s?s:0}),(0,a.jsx)("td",{children:(0,a.jsx)("span",{className:"badge ".concat(e.isActive?"badge-success":"badge-muted"),children:e.isActive?"Active":"Inactive"})}),(0,a.jsxs)("td",{onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{type:"button",className:"btn-sm btn-edit",onClick:()=>g(e),children:"Edit"}),(0,a.jsx)("button",{type:"button",className:"btn-sm btn-danger",onClick:()=>j(e._id,e.name),children:"Delete"})]})]},e._id)})})]})}),o&&(0,a.jsx)(n,{product:u,onClose:v,onSuccess:v})]})}},5864:function(e,t,s){"use strict";s.d(t,{Nq:function(){return n}});let a=s(3464).Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}}),i=["/admin/auth/me","/admin/dashboard","/admin/products","/admin/orders","/admin/users"],r=e=>i.some(t=>null==e?void 0:e.includes(t));a.interceptors.request.use(e=>{{let t=localStorage.getItem("adminToken");if(r(e.url)&&!t)return window.location.href="/login",Promise.reject(Error("Admin authentication required"));t&&(e.headers.Authorization="Bearer ".concat(t))}return e}),a.interceptors.response.use(e=>e,e=>{var t;let s=null===(t=e.response)||void 0===t?void 0:t.status;return(401===s||403===s)&&(localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser"),window.location.href="/login"),Promise.reject(e)});let n={login:(e,t)=>a.post("/admin/auth/login",{email:e,password:t}),getMe:()=>a.get("/admin/auth/me"),getStats:()=>a.get("/admin/dashboard/stats"),getProducts:()=>a.get("/admin/products"),createProduct:e=>a.post("/admin/products",e),updateProduct:(e,t)=>a.put("/admin/products/".concat(e),t),deleteProduct:e=>a.delete("/admin/products/".concat(e)),getOrders:e=>a.get("/admin/orders",{params:e}),updateOrderStatus:(e,t)=>a.put("/admin/orders/".concat(e),t),verifyOrder:(e,t)=>a.patch("/admin/orders/".concat(e,"/verify"),{status:t}),deleteOrder:e=>a.delete("/admin/orders/".concat(e)),getUsers:()=>a.get("/admin/users"),updateUser:(e,t)=>a.put("/admin/users/".concat(e),t),deleteUser:e=>a.delete("/admin/users/".concat(e))}}},function(e){e.O(0,[464,971,117,744],function(){return e(e.s=1440)}),_N_E=e.O()}]);