(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[480],{1920:function(e,a,n){Promise.resolve().then(n.bind(n,2415))},2415:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return d}});var s=n(7437),t=n(2265),r=n(9376),i=n(7648),l=n(2950);let o=[{href:"/dashboard",label:"Dashboard",icon:"\uD83D\uDCCA"},{href:"/products",label:"Products",icon:"\uD83D\uDCE6"},{href:"/orders",label:"Orders",icon:"\uD83D\uDED2"},{href:"/users",label:"Users",icon:"\uD83D\uDC65"}];function d(e){var a;let{children:n}=e,d=(0,r.useRouter)(),c=(0,r.usePathname)(),{admin:u,loading:m,logout:h,isAuthenticated:v}=(0,l.a)(),[g,f]=(0,t.useState)(!1);return((0,t.useEffect)(()=>{m||v||d.replace("/login")},[m,v,d]),(0,t.useEffect)(()=>{f(!1)},[c]),m)?(0,s.jsx)("div",{className:"admin-loading",children:(0,s.jsx)("p",{children:"Loading..."})}):v?(0,s.jsxs)("div",{className:"admin-layout",children:[g&&(0,s.jsx)("div",{className:"sidebar-overlay",onClick:()=>f(!1),"aria-hidden":"true"}),(0,s.jsxs)("aside",{className:"sidebar ".concat(g?"open":""),children:[(0,s.jsxs)("div",{className:"sidebar-header",children:[(0,s.jsx)("h2",{children:"Rizwan's Ghee"}),(0,s.jsx)("span",{className:"sidebar-subtitle",children:"Admin Panel"}),(0,s.jsx)("button",{type:"button",className:"sidebar-close-btn",onClick:()=>f(!1),"aria-label":"Close menu",children:"✕"})]}),(0,s.jsx)("nav",{className:"sidebar-nav",children:o.map(e=>(0,s.jsxs)(i.default,{href:e.href,className:c===e.href?"active":"",children:[(0,s.jsx)("span",{className:"nav-icon",children:e.icon}),(0,s.jsx)("span",{className:"nav-label",children:e.label})]},e.href))}),(0,s.jsxs)("div",{className:"sidebar-footer",children:[(0,s.jsx)("div",{className:"admin-info",children:(0,s.jsx)("span",{className:"admin-email",children:null==u?void 0:u.email})}),(0,s.jsx)("button",{type:"button",className:"logout-btn",onClick:h,children:"Logout"})]})]}),(0,s.jsxs)("main",{className:"admin-main",children:[(0,s.jsxs)("header",{className:"admin-header",children:[(0,s.jsx)("button",{type:"button",className:"mobile-menu-btn",onClick:()=>f(!g),"aria-label":"Toggle menu",children:"☰"}),(0,s.jsx)("h1",{className:"page-title",children:(null===(a=o.find(e=>e.href===c))||void 0===a?void 0:a.label)||"Admin"})]}),(0,s.jsx)("div",{className:"admin-content",children:n})]})]}):null}},2950:function(e,a,n){"use strict";n.d(a,{AuthProvider:function(){return l},a:function(){return o}});var s=n(7437),t=n(2265),r=n(5864);let i=(0,t.createContext)(null);function l(e){let{children:a}=e,[n,l]=(0,t.useState)(null),[o,d]=(0,t.useState)(!0),c=(0,t.useCallback)(()=>{let e=localStorage.getItem("adminToken"),a=localStorage.getItem("adminUser");if(e&&a)try{return{token:e,admin:JSON.parse(a)}}catch(e){localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser")}return null},[]),u=(0,t.useCallback)(()=>{localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser"),l(null),window.location.href="/login"},[]),m=(0,t.useCallback)(async()=>{if(!c()){d(!1);return}try{let e=await r.Nq.getMe(),a=null==e?void 0:e.data,n=null==a?void 0:a.data;if(!(null==a?void 0:a.success)||!n){u();return}let s=(n.role||"").toLowerCase();if("admin"!==s&&"superadmin"!==s){u();return}l(n),localStorage.setItem("adminUser",JSON.stringify(n))}catch(e){u()}finally{d(!1)}},[c,u]);(0,t.useEffect)(()=>{m()},[m]);let h=async(e,a)=>{var n,s,t,i,o,d,c;try{let i=await r.Nq.login(e,a),o=null==i?void 0:i.data,d=null==o?void 0:o.data;if(console.log("Login Response:",{success:null==o?void 0:o.success,role:null==d?void 0:null===(n=d.admin)||void 0===n?void 0:n.role}),!(null==o?void 0:o.success)||!(null==d?void 0:d.token)||!(null==d?void 0:d.admin))return{success:!1,message:null!==(t=null==o?void 0:o.message)&&void 0!==t?t:"Login failed"};let c=String((null===(s=d.admin)||void 0===s?void 0:s.role)||"").toLowerCase();if("admin"!==c&&"superadmin"!==c)return console.error("Access Denied: Invalid role",c),{success:!1,message:"Access denied. Admin or superadmin role required."};return localStorage.setItem("adminToken",d.token),localStorage.setItem("adminUser",JSON.stringify(d.admin)),l(d.admin),{success:!0}}catch(e){return{success:!1,message:null!==(c=null!==(d=null==e?void 0:null===(o=e.response)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.message)&&void 0!==d?d:null==e?void 0:e.message)&&void 0!==c?c:"Login failed"}}},v=!!n&&("admin"===n.role||"superadmin"===n.role);return(0,s.jsx)(i.Provider,{value:{admin:n,loading:o,login:h,logout:u,isAuthenticated:v},children:a})}function o(){let e=(0,t.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},5864:function(e,a,n){"use strict";n.d(a,{Nq:function(){return i}});let s=n(3464).Z.create({baseURL:"http://localhost:5000/api",headers:{"Content-Type":"application/json"}}),t=["/admin/auth/me","/admin/dashboard","/admin/products","/admin/orders","/admin/users"],r=e=>t.some(a=>null==e?void 0:e.includes(a));s.interceptors.request.use(e=>{{let a=localStorage.getItem("adminToken");if(r(e.url)&&!a)return window.location.href="/login",Promise.reject(Error("Admin authentication required"));a&&(e.headers.Authorization="Bearer ".concat(a))}return e}),s.interceptors.response.use(e=>e,e=>{var a;let n=null===(a=e.response)||void 0===a?void 0:a.status;return(401===n||403===n)&&(localStorage.removeItem("adminToken"),localStorage.removeItem("adminUser"),window.location.href="/login"),Promise.reject(e)});let i={login:(e,a)=>s.post("/admin/auth/login",{email:e,password:a}),getMe:()=>s.get("/admin/auth/me"),getStats:()=>s.get("/admin/dashboard/stats"),getProducts:()=>s.get("/admin/products"),createProduct:e=>s.post("/admin/products",e),updateProduct:(e,a)=>s.put("/admin/products/".concat(e),a),deleteProduct:e=>s.delete("/admin/products/".concat(e)),getOrders:e=>s.get("/admin/orders",{params:e}),updateOrderStatus:(e,a)=>s.put("/admin/orders/".concat(e),a),verifyOrder:(e,a)=>s.patch("/admin/orders/".concat(e,"/verify"),{status:a}),deleteOrder:e=>s.delete("/admin/orders/".concat(e)),getUsers:()=>s.get("/admin/users"),updateUser:(e,a)=>s.put("/admin/users/".concat(e),a),deleteUser:e=>s.delete("/admin/users/".concat(e))}}},function(e){e.O(0,[464,448,971,117,744],function(){return e(e.s=1920)}),_N_E=e.O()}]);